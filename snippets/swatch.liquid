{% comment %}
  Renders a swatch component for product variants
  Accepts:
  - swatch: {SwatchDrop} the swatch drop
  - shape: {String} swatch shape. Accepts 'square', defaults to circle (optional)
  - value: {String} the variant value to display (optional)

  Usage:
   {% render 'swatch', swatch: swatch, shape: shape, value: value %}
{% endcomment %}

{%- liquid
  assign swatch_focal_point = null
  if swatch.image
    assign image_url = swatch.image | image_url: width: 50
    assign swatch_value = 'url(' | append: image_url | append: ')'
    assign swatch_focal_point = swatch.image.presentation.focal_point
  elsif swatch.color
    assign swatch_value = 'rgb(' | append: swatch.color.rgb | append: ')'
  else
    assign swatch_value = null
  endif
-%}

{%- if swatch_value -%}
  <span
    class="swatch swatch--{{ shape | default: 'circle' }}"
    style="
      background-color: {{ swatch_value }};
      {% if swatch_focal_point %}
        background-position: {{ swatch_focal_point }};
      {% endif %}
    "
  >
    {%- if shape == 'square' and value -%}
      <span class="swatch__text">{{ value }}</span>
    {%- endif -%}
  </span>
{%- else -%}
  <span class="swatch swatch--{{ shape | default: 'circle' }} swatch--empty">
    <span class="swatch__text">{{ value | default: swatch.name | default: 'N/A' }}</span>
  </span>
{%- endif -%}